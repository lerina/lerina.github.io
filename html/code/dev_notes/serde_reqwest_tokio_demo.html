<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>serde_reqwest_tokio_demo serde_reqwest_tokio_demo</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="https://lerina.github.io/css/styles_min.css" />
</head>
<body>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#demo">Demo</a>
<ul>
<li><a href="#setup">Setup</a></li>
<li><a href="#starting-point">Starting point</a></li>
<li><a href="#with-reqwest">with reqwest</a></li>
<li><a href="#with-serde">with Serde</a>
<ul>
<li><a href="#handling-arbitrary-json-data">Handling Arbitrary JSON Data</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
<h1 id="demo">Demo</h1>
<p><a href="https://blog.ediri.io/serialize-and-deserialize-data-in-rust-using-serde-and-serdejson">SOURCE</a><br />
Note: He cut and paste material from <code>fasterthanlime</code> so I feel no pb to use this as a quick dev_note on Serde.<br />
<br/> We will use the reqwest library to talk to a REST API. The reqwest library provides a convenient, high-level client build on the hyper library. By default reqwest includes a client that is able of making asynchronous requests. But you can also use the reqwest library in a synchronous way if you don‚Äôt want the added complexity of asynchronous code.<br />
For this demo application, we will use the asynchronous client and will need to add tokio to our project. tokio is a runtime for asynchronous Rust ü¶Ä applications.</p>
<p>For this demo application, we will use the <a href="https://dummyjson.com/">DummyJSON REST API</a>.</p>
<h2 id="setup">Setup</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="ex">cargo</span> new demo</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="bu">cd</span> demo</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="ex">cargo</span> add reqwest --features=<span class="st">&quot;json&quot;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a><span class="ex">cargo</span> add serde --features=<span class="st">&quot;derive&quot;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a><span class="ex">cargo</span> add tokio --features=<span class="st">&quot;full&quot;</span></span></code></pre></div>
<h2 id="starting-point">Starting point</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="at">#[</span><span class="pp">tokio::</span>main<span class="at">]</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="kw">async</span> <span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a>    <span class="pp">println!</span>(<span class="st">&quot;Hello, world!&quot;</span>)<span class="op">;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a><span class="op">}</span></span></code></pre></div>
<h2 id="with-reqwest">with reqwest</h2>
<p>We create a new reqwest client and then we make a GET request to the DummyJSON product API. We use await to wait for the response and then turn the response into a string also awaiting this operation. After all this, we save the string into a variable called product and finally, print it to the terminal</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="kw">use</span> <span class="pp">reqwest::</span><span class="op">{</span>Client<span class="op">,</span> <span class="bu">Error</span><span class="op">};</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a><span class="at">#[</span><span class="pp">tokio::</span>main<span class="at">]</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a><span class="kw">async</span> <span class="kw">fn</span> main() <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>()<span class="op">,</span> <span class="bu">Error</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a>    <span class="kw">let</span> product <span class="op">=</span> <span class="pp">Client::</span>new()</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a>        <span class="op">.</span>get(<span class="st">&quot;https://dummyjson.com/products/1&quot;</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a>        <span class="op">.</span>send()</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a>        <span class="op">.</span><span class="kw">await</span><span class="op">?</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a>        <span class="op">.</span>text()</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a>        <span class="op">.</span><span class="kw">await</span><span class="op">?;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a>    <span class="pp">println!</span>(<span class="st">&quot;{:#?}&quot;</span><span class="op">,</span> product)<span class="op">;</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a>    <span class="cn">Ok</span>(())</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a><span class="op">}</span></span></code></pre></div>
<p>As we used the await method which will return a future, we need to handle possible errors in the main function too. The main function will return a Result type and a reqwest::Error if something goes wrong.</p>
<p>Run it</p>
<pre><code>cargo run</code></pre>
<p>Output:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="st">&quot;{</span><span class="dt">\&quot;</span><span class="st">id</span><span class="dt">\&quot;</span><span class="st">:1,</span><span class="dt">\&quot;</span><span class="st">title</span><span class="dt">\&quot;</span><span class="st">:</span><span class="dt">\&quot;</span><span class="st">iPhone 9</span><span class="dt">\&quot;</span><span class="st">,</span><span class="dt">\&quot;</span><span class="st">description</span><span class="dt">\&quot;</span><span class="st">:</span><span class="dt">\&quot;</span><span class="st">An apple mobile which is nothing like apple</span><span class="dt">\&quot;</span><span class="st">,</span><span class="dt">\&quot;</span><span class="st">price</span><span class="dt">\&quot;</span><span class="st">:549,</span><span class="dt">\&quot;</span><span class="st">discountPercentage</span><span class="dt">\&quot;</span><span class="st">:12.96,</span><span class="dt">\&quot;</span><span class="st">rating</span><span class="dt">\&quot;</span><span class="st">:4.69,</span><span class="dt">\&quot;</span><span class="st">stock</span><span class="dt">\&quot;</span><span class="st">:94,</span><span class="dt">\&quot;</span><span class="st">brand</span><span class="dt">\&quot;</span><span class="st">:</span><span class="dt">\&quot;</span><span class="st">Apple</span><span class="dt">\&quot;</span><span class="st">,</span><span class="dt">\&quot;</span><span class="st">category</span><span class="dt">\&quot;</span><span class="st">:</span><span class="dt">\&quot;</span><span class="st">smartphones</span><span class="dt">\&quot;</span><span class="st">,</span><span class="dt">\&quot;</span><span class="st">thumbnail</span><span class="dt">\&quot;</span><span class="st">:</span><span class="dt">\&quot;</span><span class="st">https://i.dummyjson.com/data/products/1/thumbnail.jpg</span><span class="dt">\&quot;</span><span class="st">,</span><span class="dt">\&quot;</span><span class="st">images</span><span class="dt">\&quot;</span><span class="st">:[</span><span class="dt">\&quot;</span><span class="st">https://i.dummyjson.com/data/products/1/1.jpg</span><span class="dt">\&quot;</span><span class="st">,</span><span class="dt">\&quot;</span><span class="st">https://i.dummyjson.com/data/products/1/2.jpg</span><span class="dt">\&quot;</span><span class="st">,</span><span class="dt">\&quot;</span><span class="st">https://i.dummyjson.com/data/products/1/3.jpg</span><span class="dt">\&quot;</span><span class="st">,</span><span class="dt">\&quot;</span><span class="st">https://i.dummyjson.com/data/products/1/4.jpg</span><span class="dt">\&quot;</span><span class="st">,</span><span class="dt">\&quot;</span><span class="st">https://i.dummyjson.com/data/products/1/thumbnail.jpg</span><span class="dt">\&quot;</span><span class="st">]}&quot;</span></span></code></pre></div>
<h2 id="with-serde">with Serde</h2>
<p>Let‚Äôs deserialize the JSON data into a Rust ü¶Ä struct.</p>
<p>To deserialize the response from the DummyJSON API into a Rust ü¶Ä struct, we need to create a struct called Product that matches the JSON data we get from the API.</p>
<p>The first thing to do is to import the Serialize and Deserialize traits from the serde library:</p>
<pre><code>// src/main.rs
...
use serde::{Deserialize, Serialize};
...</code></pre>
<p>Now we can create the Product struct and add the Serialize and Deserialize traits to it:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="at">#[</span>derive<span class="at">(</span><span class="bu">Debug</span><span class="op">,</span> Serialize<span class="op">,</span> Deserialize<span class="at">)]</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a><span class="at">#[</span>serde<span class="at">(</span>rename_all <span class="op">=</span> <span class="st">&quot;camelCase&quot;</span><span class="at">)]</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a><span class="kw">pub</span> <span class="kw">struct</span> <span class="bu">Product</span> <span class="op">{</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a>    <span class="kw">pub</span> id<span class="op">:</span> <span class="dt">i64</span><span class="op">,</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a>    <span class="kw">pub</span> title<span class="op">:</span> <span class="dt">String</span><span class="op">,</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a>    <span class="kw">pub</span> description<span class="op">:</span> <span class="dt">String</span><span class="op">,</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a>    <span class="kw">pub</span> price<span class="op">:</span> <span class="dt">i64</span><span class="op">,</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a>    <span class="kw">pub</span> rating<span class="op">:</span> <span class="dt">f64</span><span class="op">,</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true"></a>    <span class="kw">pub</span> stock<span class="op">:</span> <span class="dt">i64</span><span class="op">,</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true"></a>    <span class="kw">pub</span> brand<span class="op">:</span> <span class="dt">String</span><span class="op">,</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true"></a>    <span class="kw">pub</span> category<span class="op">:</span> <span class="dt">String</span><span class="op">,</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true"></a>    <span class="kw">pub</span> thumbnail<span class="op">:</span> <span class="dt">String</span><span class="op">,</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true"></a>    <span class="kw">pub</span> images<span class="op">:</span> <span class="dt">Vec</span><span class="op">&lt;</span><span class="dt">String</span><span class="op">&gt;,</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true"></a><span class="op">}</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true"></a><span class="at">#[</span><span class="pp">tokio::</span>main<span class="at">]</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true"></a><span class="kw">async</span> <span class="kw">fn</span> main() <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>()<span class="op">,</span> <span class="bu">Error</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true"></a>    <span class="op">...</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true"></a><span class="op">}</span></span></code></pre></div>
<p>As the API returns the JSON data in camelCase, we need to add the #[serde(rename_all = ‚ÄúcamelCase‚Äù)] attribute to the struct as in Rust ü¶Ä by convention, the struct fields are in snake case.</p>
<p>Now that we have the Product struct, we can deserialize the JSON data into a Product struct. Instead of converting the response to a string, we can convert it directly to a Product struct.</p>
<p>We do this by using the json method on the response and then awaiting the result. The json method will deserialize the JSON data into a Product struct. We explicitly annotate the type of the variable product to be a Product struct.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="at">#[</span><span class="pp">tokio::</span>main<span class="at">]</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a><span class="kw">async</span> <span class="kw">fn</span> main() <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>()<span class="op">,</span> <span class="bu">Error</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a>    <span class="co">//let product = Client::new()</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a>    <span class="kw">let</span> product<span class="op">:</span> <span class="bu">Product</span> <span class="op">=</span> <span class="pp">Client::</span>new()</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a>        <span class="op">.</span>get(<span class="st">&quot;https://dummyjson.com/products/1&quot;</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true"></a>        <span class="op">.</span>send()</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true"></a>        <span class="op">.</span><span class="kw">await</span><span class="op">?</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true"></a>        <span class="op">.</span>json()</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true"></a>        <span class="op">.</span><span class="kw">await</span><span class="op">?;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true"></a>    <span class="pp">println!</span>(<span class="st">&quot;{:#?}&quot;</span><span class="op">,</span> product)<span class="op">;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true"></a>    <span class="cn">Ok</span>(())</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true"></a><span class="op">}</span></span></code></pre></div>
<p>Run it</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="ex">cargo</span> run</span></code></pre></div>
<p>Output:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="ex">Product</span> {</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a>    <span class="ex">id</span>: 1,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a>    <span class="ex">title</span>: <span class="st">&quot;iPhone 9&quot;</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a>    <span class="ex">description</span>: <span class="st">&quot;An apple mobile which is nothing like apple&quot;</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a>    <span class="ex">price</span>: 549,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true"></a>    <span class="ex">rating</span>: 4.69,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true"></a>    <span class="ex">stock</span>: 94,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true"></a>    <span class="ex">brand</span>: <span class="st">&quot;Apple&quot;</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true"></a>    <span class="ex">category</span>: <span class="st">&quot;smartphones&quot;</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true"></a>    <span class="ex">thumbnail</span>: <span class="st">&quot;https://i.dummyjson.com/data/products/1/thumbnail.jpg&quot;</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true"></a>    <span class="ex">images</span>: [</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true"></a>        <span class="st">&quot;https://i.dummyjson.com/data/products/1/1.jpg&quot;</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true"></a>        <span class="st">&quot;https://i.dummyjson.com/data/products/1/2.jpg&quot;</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true"></a>        <span class="st">&quot;https://i.dummyjson.com/data/products/1/3.jpg&quot;</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true"></a>        <span class="st">&quot;https://i.dummyjson.com/data/products/1/4.jpg&quot;</span>,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true"></a>        <span class="st">&quot;https://i.dummyjson.com/data/products/1/thumbnail.jpg&quot;</span>,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true"></a>    ],</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true"></a>}</span></code></pre></div>
<p>Now we can change our code to serialize a Product struct to JSON data and post it to the DummyJSON API create product endpoint.</p>
<p>We need to create a Product struct and fill it with some data. We then need to create a new reqwest::Client but this time we use post instead of get method. We then set the body of the request to JSON and pass a reference to our newly created Product struct. We then await the response and turn the response into json and await the result. The result will then be saved in the new_product variable to finally print it to the terminal.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="co">// src/main.rs</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a><span class="op">...</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a><span class="at">#[</span><span class="pp">tokio::</span>main<span class="at">]</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a><span class="kw">async</span> <span class="kw">fn</span> main() <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>()<span class="op">,</span> <span class="bu">Error</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a>    <span class="kw">let</span> product<span class="op">:</span> <span class="bu">Product</span> <span class="op">=</span> <span class="pp">Client::</span>new()</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a>        <span class="op">.</span>get(<span class="st">&quot;https://dummyjson.com/products/1&quot;</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true"></a>        <span class="op">.</span>send()</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true"></a>        <span class="op">.</span><span class="kw">await</span><span class="op">?</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true"></a>        <span class="op">.</span>json()</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true"></a>        <span class="op">.</span><span class="kw">await</span><span class="op">?;</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true"></a>    <span class="pp">println!</span>(<span class="st">&quot;{:#?}&quot;</span><span class="op">,</span> product)<span class="op">;</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true"></a>    <span class="kw">let</span> new_product <span class="op">=</span> <span class="bu">Product</span> <span class="op">{</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true"></a>        id<span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true"></a>        title<span class="op">:</span> <span class="st">&quot;Macbook Pro&quot;</span><span class="op">.</span>to_owned()<span class="op">,</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true"></a>        description<span class="op">:</span> <span class="st">&quot;Best laptop ever&quot;</span><span class="op">.</span>to_owned()<span class="op">,</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true"></a>        price<span class="op">:</span> <span class="dv">100</span><span class="op">,</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true"></a>        rating<span class="op">:</span> <span class="dv">0.0</span><span class="op">,</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true"></a>        stock<span class="op">:</span> <span class="dv">100</span><span class="op">,</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true"></a>        brand<span class="op">:</span> <span class="st">&quot;Apple&quot;</span><span class="op">.</span>to_owned()<span class="op">,</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true"></a>        category<span class="op">:</span> <span class="st">&quot;laptops&quot;</span><span class="op">.</span>to_owned()<span class="op">,</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true"></a>        thumbnail<span class="op">:</span> <span class="st">&quot;https://dummyimage.com/300x300/000/fff&quot;</span><span class="op">.</span>to_owned()<span class="op">,</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true"></a>        images<span class="op">:</span> <span class="pp">vec!</span>[</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true"></a>            <span class="st">&quot;https://dummyimage.com/300x300/000/fff&quot;</span><span class="op">.</span>to_owned()<span class="op">,</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true"></a>            <span class="st">&quot;https://dummyimage.com/600x600/000/fff&quot;</span><span class="op">.</span>to_owned()<span class="op">,</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true"></a>        ]<span class="op">,</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true"></a>    <span class="op">};</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true"></a></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true"></a>    <span class="kw">let</span> new_product<span class="op">:</span> <span class="bu">Product</span> <span class="op">=</span> <span class="pp">Client::</span>new()</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true"></a>        <span class="op">.</span>post(<span class="st">&quot;https://dummyjson.com/products/add&quot;</span>)</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true"></a>        <span class="op">.</span>header(<span class="st">&quot;Content-Type&quot;</span><span class="op">,</span> <span class="st">&quot;application/json&quot;</span>)</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true"></a>        <span class="op">.</span>json(<span class="op">&amp;</span>new_product)</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true"></a>        <span class="op">.</span>send()</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true"></a>        <span class="op">.</span><span class="kw">await</span><span class="op">?</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true"></a>        <span class="op">.</span>json()</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true"></a>        <span class="op">.</span><span class="kw">await</span><span class="op">?;</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true"></a>    <span class="pp">println!</span>(<span class="st">&quot;{:#?}&quot;</span><span class="op">,</span> new_product)<span class="op">;</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true"></a>    <span class="cn">Ok</span>(())</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true"></a><span class="op">}</span></span></code></pre></div>
<p>If we run the application now, we should see our new Product successfully created with a new ID (101)</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="ex">cargo</span> run</span></code></pre></div>
<p>Output:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="ex">Product</span> {</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a>    <span class="ex">id</span>: 1,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a>    <span class="ex">title</span>: <span class="st">&quot;iPhone 9&quot;</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a>    <span class="ex">description</span>: <span class="st">&quot;An apple mobile which is nothing like apple&quot;</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a>    <span class="ex">price</span>: 549,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true"></a>    <span class="ex">rating</span>: 4.69,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true"></a>    <span class="ex">stock</span>: 94,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true"></a>    <span class="ex">brand</span>: <span class="st">&quot;Apple&quot;</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true"></a>    <span class="ex">category</span>: <span class="st">&quot;smartphones&quot;</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true"></a>    <span class="ex">thumbnail</span>: <span class="st">&quot;https://i.dummyjson.com/data/products/1/thumbnail.jpg&quot;</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true"></a>    <span class="ex">images</span>: [</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true"></a>        <span class="st">&quot;https://i.dummyjson.com/data/products/1/1.jpg&quot;</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true"></a>        <span class="st">&quot;https://i.dummyjson.com/data/products/1/2.jpg&quot;</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true"></a>        <span class="st">&quot;https://i.dummyjson.com/data/products/1/3.jpg&quot;</span>,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true"></a>        <span class="st">&quot;https://i.dummyjson.com/data/products/1/4.jpg&quot;</span>,</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true"></a>        <span class="st">&quot;https://i.dummyjson.com/data/products/1/thumbnail.jpg&quot;</span>,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true"></a>    ],</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true"></a>}</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true"></a><span class="ex">Product</span> {</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true"></a>    <span class="ex">id</span>: 101,</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true"></a>    <span class="ex">title</span>: <span class="st">&quot;Macbook Pro&quot;</span>,</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true"></a>    <span class="ex">description</span>: <span class="st">&quot;Best laptop ever&quot;</span>,</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true"></a>    <span class="ex">price</span>: 100,</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true"></a>    <span class="ex">rating</span>: 0.0,</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true"></a>    <span class="ex">stock</span>: 100,</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true"></a>    <span class="ex">brand</span>: <span class="st">&quot;Apple&quot;</span>,</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true"></a>    <span class="ex">category</span>: <span class="st">&quot;laptops&quot;</span>,</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true"></a>    <span class="ex">thumbnail</span>: <span class="st">&quot;https://dummyimage.com/300x300/000/fff&quot;</span>,</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true"></a>    <span class="ex">images</span>: [</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true"></a>        <span class="st">&quot;https://dummyimage.com/300x300/000/fff&quot;</span>,</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true"></a>        <span class="st">&quot;https://dummyimage.com/600x600/000/fff&quot;</span>,</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true"></a>    ],</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true"></a>}</span></code></pre></div>
<p>That works fine, we saw how to serialize and deserialize JSON data in Rust ü¶Ä.</p>
<p>But we are not finished as I want to show is how to handle arbitrary JSON data.</p>
<h3 id="handling-arbitrary-json-data">Handling Arbitrary JSON Data</h3>
<p>To start with, add the serde_json crate to our project:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a>cargo add serde_json</span></code></pre></div>
<p>serde_json gives us access to a macro called serde_json::json! which allows using regular JSON syntax to create arbitrary JSON data.</p>
<p>We can add a new reqwest::Client to our application and instead use the Product struct, will switch to the serde_json::json! macro.</p>
<p>We will also change the explicit type annotation of the product variable to <code>serde_json::Value</code> instead of the <code>Product struct</code>.<br />
<code>serde_json::Value</code> will represent an arbitrary valid JSON value.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a><span class="co">// src/main.rs</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a><span class="op">...</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a><span class="kw">use</span> <span class="pp">serde_json::</span><span class="op">{</span>json<span class="op">,</span> Value<span class="op">};</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true"></a><span class="op">...</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true"></a><span class="at">#[</span><span class="pp">tokio::</span>main<span class="at">]</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true"></a><span class="kw">async</span> <span class="kw">fn</span> main() <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>()<span class="op">,</span> <span class="bu">Error</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true"></a>    <span class="op">...</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true"></a>    <span class="co">//making use of serde_json</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true"></a>    <span class="kw">let</span> new_product_arbitary_json<span class="op">:</span> Value <span class="op">=</span> <span class="pp">Client::</span>new()</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true"></a>        <span class="op">.</span>post(<span class="st">&quot;https://dummyjson.com/products/add&quot;</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true"></a>        <span class="op">.</span>header(<span class="st">&quot;Content-Type&quot;</span><span class="op">,</span> <span class="st">&quot;application/json&quot;</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true"></a>        <span class="op">.</span>json(<span class="op">&amp;</span><span class="pp">json!</span>(<span class="op">{</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true"></a>            <span class="st">&quot;id&quot;</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true"></a>            <span class="st">&quot;title&quot;</span><span class="op">:</span> <span class="st">&quot;Macbook Pro&quot;</span><span class="op">,</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true"></a>            <span class="st">&quot;description&quot;</span><span class="op">:</span> <span class="st">&quot;Best laptop ever&quot;</span><span class="op">,</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true"></a>            <span class="st">&quot;price&quot;</span><span class="op">:</span> <span class="dv">100</span><span class="op">,</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true"></a>            <span class="st">&quot;rating&quot;</span><span class="op">:</span> <span class="dv">0.0</span><span class="op">,</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true"></a>            <span class="st">&quot;stock&quot;</span><span class="op">:</span> <span class="dv">100</span><span class="op">,</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true"></a>            <span class="st">&quot;brand&quot;</span><span class="op">:</span> <span class="st">&quot;Apple&quot;</span><span class="op">,</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true"></a>            <span class="st">&quot;category&quot;</span><span class="op">:</span> <span class="st">&quot;laptops&quot;</span><span class="op">,</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true"></a>            <span class="st">&quot;thumbnail&quot;</span><span class="op">:</span> <span class="st">&quot;https://dummyimage.com/300x300/000/fff&quot;</span><span class="op">,</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true"></a>            <span class="st">&quot;images&quot;</span><span class="op">:</span> [</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true"></a>                <span class="st">&quot;https://dummyimage.com/300x300/000/fff&quot;</span><span class="op">,</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true"></a>                <span class="st">&quot;https://dummyimage.com/600x600/000/fff&quot;</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true"></a>            ]</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true"></a>        <span class="op">}</span>))</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true"></a>        <span class="op">.</span>send()</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true"></a>        <span class="op">.</span><span class="kw">await</span><span class="op">?</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true"></a>        <span class="op">.</span>json()</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true"></a>        <span class="op">.</span><span class="kw">await</span><span class="op">?;</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true"></a></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true"></a>    <span class="pp">println!</span>(<span class="st">&quot;{:#?}&quot;</span><span class="op">,</span> new_product_arbitary_json)<span class="op">;</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true"></a></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true"></a>    <span class="cn">Ok</span>(())</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true"></a><span class="op">}</span><span class="co">//^-- main.rs</span></span></code></pre></div>
<p>Output:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="ex">...</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true"></a><span class="ex">Product</span> {</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true"></a>    <span class="ex">id</span>: 101,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true"></a>    <span class="ex">title</span>: <span class="st">&quot;Macbook Pro&quot;</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true"></a>    <span class="ex">description</span>: <span class="st">&quot;Best laptop ever&quot;</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true"></a>    <span class="ex">price</span>: 100,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true"></a>    <span class="ex">rating</span>: 0.0,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true"></a>    <span class="ex">stock</span>: 100,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true"></a>    <span class="ex">brand</span>: <span class="st">&quot;Apple&quot;</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true"></a>    <span class="ex">category</span>: <span class="st">&quot;laptops&quot;</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true"></a>    <span class="ex">thumbnail</span>: <span class="st">&quot;https://dummyimage.com/300x300/000/fff&quot;</span>,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true"></a>    <span class="ex">images</span>: [</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true"></a>        <span class="st">&quot;https://dummyimage.com/300x300/000/fff&quot;</span>,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true"></a>        <span class="st">&quot;https://dummyimage.com/600x600/000/fff&quot;</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true"></a>    ],</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true"></a>}</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true"></a><span class="ex">Object</span> {</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true"></a>    <span class="st">&quot;brand&quot;</span>: <span class="ex">String</span>(<span class="st">&quot;Apple&quot;</span>),</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true"></a>    <span class="st">&quot;category&quot;</span>: <span class="ex">String</span>(<span class="st">&quot;laptops&quot;</span>),</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true"></a>    <span class="st">&quot;description&quot;</span>: <span class="ex">String</span>(<span class="st">&quot;Best laptop ever&quot;</span>),</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true"></a>    <span class="st">&quot;id&quot;</span>: <span class="ex">Number</span>(101),</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true"></a>    <span class="st">&quot;images&quot;</span>: <span class="ex">Array</span> [</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true"></a>        <span class="ex">String</span>(<span class="st">&quot;https://dummyimage.com/300x300/000/fff&quot;</span>),</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true"></a>        <span class="ex">String</span>(<span class="st">&quot;https://dummyimage.com/600x600/000/fff&quot;</span>),</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true"></a>    ],</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true"></a>    <span class="st">&quot;price&quot;</span>: <span class="ex">Number</span>(100),</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true"></a>    <span class="st">&quot;rating&quot;</span>: <span class="ex">Number</span>(0),</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true"></a>    <span class="st">&quot;stock&quot;</span>: <span class="ex">Number</span>(100),</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true"></a>    <span class="st">&quot;thumbnail&quot;</span>: <span class="ex">String</span>(<span class="st">&quot;https://dummyimage.com/300x300/000/fff&quot;</span>),</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true"></a>    <span class="st">&quot;title&quot;</span>: <span class="ex">String</span>(<span class="st">&quot;Macbook Pro&quot;</span>),</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true"></a>}</span></code></pre></div>
<p>With <code>serde_json</code> you will get different <code>serde_json:from_*</code> methods to parse JSON data, for example, we can use the <code>serde_json::from_str</code> function to parse a JSON string into structured data.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a><span class="op">...</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a><span class="at">#[</span><span class="pp">tokio::</span>main<span class="at">]</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a><span class="kw">async</span> <span class="kw">fn</span> main() <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>()<span class="op">,</span> <span class="bu">Error</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true"></a>    <span class="op">...</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true"></a>    <span class="co">// clone because we are using new_product_arbitary_json again later</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true"></a>    <span class="kw">let</span> test<span class="op">:</span> <span class="bu">Product</span> <span class="op">=</span> <span class="pp">serde_json::</span>from_value(new_product_arbitary_json<span class="op">.</span>clone())<span class="op">.</span>unwrap()<span class="op">;</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true"></a>    <span class="pp">println!</span>(<span class="st">&quot;{:#?}&quot;</span><span class="op">,</span> test)<span class="op">;</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true"></a>    <span class="cn">Ok</span>(())</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true"></a><span class="op">}</span></span></code></pre></div>
<p>Output:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a><span class="ex">...</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a><span class="ex">Object</span> {</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true"></a>    <span class="st">&quot;brand&quot;</span>: <span class="ex">String</span>(<span class="st">&quot;Apple&quot;</span>),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true"></a>    <span class="st">&quot;category&quot;</span>: <span class="ex">String</span>(<span class="st">&quot;laptops&quot;</span>),</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true"></a>    <span class="st">&quot;description&quot;</span>: <span class="ex">String</span>(<span class="st">&quot;Best laptop ever&quot;</span>),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true"></a>    <span class="st">&quot;id&quot;</span>: <span class="ex">Number</span>(101),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true"></a>    <span class="st">&quot;images&quot;</span>: <span class="ex">Array</span> [</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true"></a>        <span class="ex">String</span>(<span class="st">&quot;https://dummyimage.com/300x300/000/fff&quot;</span>),</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true"></a>        <span class="ex">String</span>(<span class="st">&quot;https://dummyimage.com/600x600/000/fff&quot;</span>),</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true"></a>    ],</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true"></a>    <span class="st">&quot;price&quot;</span>: <span class="ex">Number</span>(100),</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true"></a>    <span class="st">&quot;rating&quot;</span>: <span class="ex">Number</span>(0),</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true"></a>    <span class="st">&quot;stock&quot;</span>: <span class="ex">Number</span>(100),</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true"></a>    <span class="st">&quot;thumbnail&quot;</span>: <span class="ex">String</span>(<span class="st">&quot;https://dummyimage.com/300x300/000/fff&quot;</span>),</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true"></a>    <span class="st">&quot;title&quot;</span>: <span class="ex">String</span>(<span class="st">&quot;Macbook Pro&quot;</span>),</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true"></a>}</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true"></a><span class="ex">Product</span> {</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true"></a>    <span class="ex">id</span>: 101,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true"></a>    <span class="ex">title</span>: <span class="st">&quot;Macbook Pro&quot;</span>,</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true"></a>    <span class="ex">description</span>: <span class="st">&quot;Best laptop ever&quot;</span>,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true"></a>    <span class="ex">price</span>: 100,</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true"></a>    <span class="ex">rating</span>: 0.0,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true"></a>    <span class="ex">stock</span>: 100,</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true"></a>    <span class="ex">brand</span>: <span class="st">&quot;Apple&quot;</span>,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true"></a>    <span class="ex">category</span>: <span class="st">&quot;laptops&quot;</span>,</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true"></a>    <span class="ex">thumbnail</span>: <span class="st">&quot;https://dummyimage.com/300x300/000/fff&quot;</span>,</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true"></a>    <span class="ex">images</span>: [</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true"></a>        <span class="st">&quot;https://dummyimage.com/300x300/000/fff&quot;</span>,</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true"></a>        <span class="st">&quot;https://dummyimage.com/600x600/000/fff&quot;</span>,</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true"></a>    ],</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true"></a>}</span></code></pre></div>
<p>If you have arbitrary JSON data of type serde_json::Value, you can access the data using the Value:get method. This is very similar to HashMap::get method or Vec::get method. The Value::get method will return an Option since the key might not exist in the JSON data.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode rust"><code class="sourceCode rust"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a><span class="at">#[</span><span class="pp">tokio::</span>main<span class="at">]</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a><span class="kw">async</span> <span class="kw">fn</span> main() <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>()<span class="op">,</span> <span class="bu">Error</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a>    <span class="op">...</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true"></a>    <span class="kw">let</span> cloned_product <span class="op">=</span> new_product_arbitary_json<span class="op">.</span>clone()<span class="op">;</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true"></a>    <span class="kw">let</span> test<span class="op">:</span> <span class="bu">Product</span> <span class="op">=</span> <span class="pp">serde_json::</span>from_value(new_product_arbitary_json)<span class="op">.</span>unwrap()<span class="op">;</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true"></a>    <span class="pp">println!</span>(<span class="st">&quot;{:#?}&quot;</span><span class="op">,</span> test)<span class="op">;</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true"></a>    <span class="kw">let</span> description <span class="op">=</span> cloned_product<span class="op">.</span>get(<span class="st">&quot;description&quot;</span>)<span class="op">;</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true"></a>    <span class="kw">match</span> description <span class="op">{</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true"></a>        <span class="cn">Some</span>(d) <span class="op">=&gt;</span> <span class="pp">println!</span>(<span class="st">&quot;Description: {}&quot;</span><span class="op">,</span> d)<span class="op">,</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true"></a>        <span class="cn">None</span> <span class="op">=&gt;</span> <span class="pp">println!</span>(<span class="st">&quot;No description&quot;</span>)<span class="op">,</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true"></a>    <span class="op">}</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true"></a>    <span class="cn">Ok</span>(())</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true"></a><span class="op">}</span></span></code></pre></div>
<p>Output:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="ex">...</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a><span class="ex">Product</span> {</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true"></a>    <span class="ex">id</span>: 101,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true"></a>    <span class="ex">title</span>: <span class="st">&quot;Macbook Pro&quot;</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true"></a>    <span class="ex">description</span>: <span class="st">&quot;Best laptop ever&quot;</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true"></a>    <span class="ex">price</span>: 100,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true"></a>    <span class="ex">rating</span>: 0.0,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true"></a>    <span class="ex">stock</span>: 100,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true"></a>    <span class="ex">brand</span>: <span class="st">&quot;Apple&quot;</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true"></a>    <span class="ex">category</span>: <span class="st">&quot;laptops&quot;</span>,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true"></a>    <span class="ex">thumbnail</span>: <span class="st">&quot;https://dummyimage.com/300x300/000/fff&quot;</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true"></a>    <span class="ex">images</span>: [</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true"></a>        <span class="st">&quot;https://dummyimage.com/300x300/000/fff&quot;</span>,</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true"></a>        <span class="st">&quot;https://dummyimage.com/600x600/000/fff&quot;</span>,</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true"></a>    ],</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true"></a>}</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true"></a><span class="ex">Description</span>: <span class="st">&quot;Best laptop ever&quot;</span></span></code></pre></div>
<p>There you have it. We saw how to use reqwest to make HTTP requests and how to serialize and deserialize JSON data in Rust ü¶Ä using serde. We also tried out how to handle arbitrary JSON data using serde_json.</p>
</body>
</html>

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>index index</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="https://lerina.github.io/css/styles.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#rust-wasm-and-webassembly"
id="toc-rust-wasm-and-webassembly">Rust, Wasm and Webassembly</a></li>
<li><a href="#about-rust" id="toc-about-rust">About Rust</a></li>
</ul>
</nav>
<div class="navbar">
<a class="openbtn" onclick="openNav()">☰</a>
</div>
<main>
<h2 id="rust-wasm-and-webassembly">Rust, Wasm and Webassembly</h2>
<h2 id="about-rust">About Rust</h2>
<p>Rust is a programming language that’s focused on safety, speed, and
concurrency. Its design lets you create programs that have the
performance and control of a low-level language, but with the powerful
abstractions of a high-level language. These properties make Rust
suitable for programmers who have experience in languages like C and are
looking for a safer alternative, as well as those from languages like
Python who are looking for ways to write code that performs better
without sacrificing expressiveness. source: the <a
href="https://doc.rust-lang.org/book/foreword.html">rustbook</a></p>
<ul>
<li><p><a href="./code/secure_coding/index.html">more about
Rust…</a></p></li>
<li><p>Webassembly: Wasm</p></li>
</ul>
<p>“WebAssembly… defines a portable, size- and load-time-efficient
format and execution model” _ <a
href="https://blog.mozilla.org/luke/2015/06/17/webassembly/">Luke
Wagner</a>{taget: _blank}</p>
<p>WebAssembly is a safe, portable, and low-level binary instruction
format. Originaly designed to serve as a compilation target for the Web,
it can also be used to run applications outside of the browser, thanks
to WASI.</p>
<ul>
<li>WASI, the WebAssembly System Interface</li>
</ul>
<p>It is a modular collection of standardized APIs. None of the APIs are
required to be implemented to have a compliant runtime. Instead, host
environments can choose which APIs make sense for their use cases. For
instance, filesystem access, environment variable support, and support
for clocks and random number generators are commonly implemented.</p>
<ul>
<li>WAGI: WebAssembly Gateway Interface</li>
</ul>
<p>WAGI is a system for building HTTP services with simple WASM+WASI
modules. It allows you to run WebAssembly WASI binaries as HTTP
handlers.</p>
<h3 id="learn-rust">Learn Rust</h3>
<ul>
<li><a href="https://doc.rust-lang.org/book/title-page.html">The
book</a></li>
<li>The best youtube resource to learn Rust is <a
href="https://www.youtube.com/c/LetsGetRusty/playlists">LetsGetRusty</a></li>
<li>my quick guide</li>
</ul>
<h3 id="learn-wasm">Learn Wasm</h3>
<h4 id="the-book">the book</h4>
<h4 id="my-no-bloat-workflow">My no-bloat workflow</h4>
<p>Wasm without npm and bundlers is actually quite simple. Unfortunately
it’s not easy to find complete examples on the web.</p>
<ul>
<li>Get the canvas smiley face example from wasm-bindgen.</li>
</ul>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/rustwasm/wasm-bindgen/</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> wasm-bindgen/examples/canvas</span></code></pre></div>
<ul>
<li>modify index.js</li>
</ul>
<p>from</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span>(<span class="st">&#39;./pkg&#39;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">catch</span>(<span class="bu">console</span><span class="op">.</span><span class="fu">error</span>)<span class="op">;</span></span></code></pre></div>
<p>to</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> init <span class="im">from</span> <span class="st">&#39;./pkg/canvas.js&#39;</span><span class="op">;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">init</span>()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">catch</span>(<span class="bu">console</span><span class="op">.</span><span class="fu">error</span>)<span class="op">;</span></span></code></pre></div>
<ul>
<li>In index.html</li>
</ul>
<p>add a script tag to bring into scope and specifies that index.js is a
module</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode numberSource html numberLines"><code class="sourceCode html"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="kw">&lt;head&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>    <span class="kw">&lt;meta</span> <span class="er">content</span><span class="ot">=</span><span class="st">&quot;text/html;charset=utf-8&quot;</span> <span class="er">http-equiv</span><span class="ot">=</span><span class="st">&quot;Content-Type&quot;</span><span class="kw">/&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="kw">&lt;/head&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="kw">&lt;body&gt;</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>    <span class="kw">&lt;canvas</span> <span class="er">id</span><span class="ot">=</span><span class="st">&quot;canvas&quot;</span> <span class="er">height</span><span class="ot">=</span><span class="st">&quot;150&quot;</span> <span class="er">width</span><span class="ot">=</span><span class="st">&quot;150&quot;</span><span class="kw">&gt;&lt;/canvas&gt;</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>  </span>
<span id="cb4-8"><a href="#cb4-8"></a>    <span class="kw">&lt;script</span><span class="ot"> type=</span><span class="st">&quot;module&quot;</span> <span class="er">src</span><span class="ot">=</span><span class="st">&quot;./index.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>  <span class="kw">&lt;/body&gt;</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
<ul>
<li>Compile using wasm-pack</li>
</ul>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">wasm-pack</span> build <span class="at">--target</span> web</span></code></pre></div>
<ul>
<li>Finaly</li>
</ul>
<p>install something to server your website if you don’t have one
installed . such as <a
href="https://github.com/thecoshman/http">http</a> or <a
href="https://github.com/kettle11/devserver">devserver</a></p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> install https</span></code></pre></div>
<p>and serve</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">http</span> ./</span></code></pre></div>
<h4 id="section"></h4>
<p>I like to keep anything non-rust in <code>www</code> so all my wasm
project uses this simple script to build and serve.</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">## pre-req a web server</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># cargo install https</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">## exit on error and  prints each executed command</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> <span class="at">-ex</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">## compile for plain vanilla no javascript framework </span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="ex">wasm-pack</span> build <span class="at">--target</span> web <span class="at">--out-dir</span> www/pkg</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">## display link for easy access</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Serving at: http://127.0.0.1:8080/html/&quot;</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co">## run the web server</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="ex">http</span> <span class="at">-a</span> 127.0.0.1 <span class="at">-p</span> 8080 www</span></code></pre></div>
<h3 id="webassembly">Webassembly</h3>
<ul>
<li>the book</li>
<li>A fun dive into Webassembly</li>
<li>other <code>resources</code> elsewhere</li>
</ul>
<div class="sourceCode" id="cb9"><pre
class="sourceCode numberSource rust numberLines"><code class="sourceCode rust"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">use</span> <span class="pp">anyhow::</span><span class="op">{</span>anyhow<span class="op">,</span> <span class="dt">Result</span><span class="op">};</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">use</span> <span class="pp">std::future::</span><span class="bu">Future</span><span class="op">;</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="kw">use</span> <span class="pp">wasm_bindgen::closure::</span><span class="op">{</span>Closure<span class="op">,</span> WasmClosureFnOnce<span class="op">,</span> WasmClosure<span class="op">};</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="kw">use</span> <span class="pp">wasm_bindgen::</span><span class="op">{</span>JsCast<span class="op">,</span> JsValue<span class="op">};</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="kw">use</span> <span class="pp">wasm_bindgen_futures::</span>JsFuture<span class="op">;</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="kw">use</span> <span class="pp">web_sys::</span><span class="op">{</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>    CanvasRenderingContext2d<span class="op">,</span> Document<span class="op">,</span> HtmlCanvasElement<span class="op">,</span> </span>
<span id="cb9-8"><a href="#cb9-8"></a>    HtmlImageElement<span class="op">,</span> Response<span class="op">,</span> Window<span class="op">,</span> Element<span class="op">,</span> HtmlElement<span class="op">,};</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="kw">use</span> <span class="pp">js_sys::</span>ArrayBuffer<span class="op">;</span></span>
<span id="cb9-10"><a href="#cb9-10"></a></span>
<span id="cb9-11"><a href="#cb9-11"></a></span>
<span id="cb9-12"><a href="#cb9-12"></a></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">// It&#39;s a macro that allows you to log in to the console with log!</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">// using a syntax such as the format! function.</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">// Taken from https://rustwasm.github.io/book/game-of-life/debugging.html</span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="pp">macro_rules!</span> log <span class="op">{</span></span>
<span id="cb9-17"><a href="#cb9-17"></a>    ( <span class="op">$</span>( <span class="op">$</span>t<span class="op">:</span>tt )<span class="op">*</span> ) <span class="op">=&gt;</span> <span class="op">{</span></span>
<span id="cb9-18"><a href="#cb9-18"></a>        <span class="pp">web_sys::console::</span>log_1(<span class="op">&amp;</span><span class="pp">format!</span>( <span class="op">$</span>( <span class="op">$</span>t )<span class="op">*</span> )<span class="op">.</span>into())<span class="op">;</span></span>
<span id="cb9-19"><a href="#cb9-19"></a>    <span class="op">}</span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="op">}</span></span>
<span id="cb9-21"><a href="#cb9-21"></a></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="pp">macro_rules!</span> error <span class="op">{</span></span>
<span id="cb9-23"><a href="#cb9-23"></a>    ( <span class="op">$</span>( <span class="op">$</span>t<span class="op">:</span>tt )<span class="op">*</span> ) <span class="op">=&gt;</span> <span class="op">{</span></span>
<span id="cb9-24"><a href="#cb9-24"></a>        <span class="pp">web_sys::console::</span>error_1(<span class="op">&amp;</span><span class="pp">format!</span>( <span class="op">$</span>( <span class="op">$</span>t )<span class="op">*</span> )<span class="op">.</span>into())<span class="op">;</span></span>
<span id="cb9-25"><a href="#cb9-25"></a>    <span class="op">}</span></span>
<span id="cb9-26"><a href="#cb9-26"></a><span class="op">}</span></span>
<span id="cb9-27"><a href="#cb9-27"></a></span>
<span id="cb9-28"><a href="#cb9-28"></a><span class="kw">pub</span> <span class="kw">fn</span> window() <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>Window<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb9-29"><a href="#cb9-29"></a>    <span class="pp">web_sys::</span>window()<span class="op">.</span>ok_or_else(<span class="op">||</span> <span class="pp">anyhow!</span>(<span class="st">&quot;No Window Found&quot;</span>))</span>
<span id="cb9-30"><a href="#cb9-30"></a><span class="op">}</span></span>
<span id="cb9-31"><a href="#cb9-31"></a></span>
<span id="cb9-32"><a href="#cb9-32"></a><span class="kw">pub</span> <span class="kw">fn</span> document() <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>Document<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb9-33"><a href="#cb9-33"></a>    window()<span class="op">?</span></span>
<span id="cb9-34"><a href="#cb9-34"></a>        <span class="op">.</span>document()</span>
<span id="cb9-35"><a href="#cb9-35"></a>        <span class="op">.</span>ok_or_else(<span class="op">||</span> <span class="pp">anyhow!</span>(<span class="st">&quot;No Document Found&quot;</span>))</span>
<span id="cb9-36"><a href="#cb9-36"></a><span class="op">}</span></span>
<span id="cb9-37"><a href="#cb9-37"></a></span>
<span id="cb9-38"><a href="#cb9-38"></a><span class="kw">pub</span> <span class="kw">fn</span> canvas() <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>HtmlCanvasElement<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb9-39"><a href="#cb9-39"></a>    document()<span class="op">?</span></span>
<span id="cb9-40"><a href="#cb9-40"></a>        <span class="op">.</span>get_element_by_id(<span class="st">&quot;canvas&quot;</span>)</span>
<span id="cb9-41"><a href="#cb9-41"></a>        <span class="op">.</span>ok_or_else(<span class="op">||</span> <span class="pp">anyhow!</span>(<span class="st">&quot;No Canvas Element found with ID &#39;canvas&#39;&quot;</span>))<span class="op">?</span></span>
<span id="cb9-42"><a href="#cb9-42"></a>        <span class="op">.</span><span class="pp">dyn_into::</span><span class="op">&lt;</span><span class="pp">web_sys::</span>HtmlCanvasElement<span class="op">&gt;</span>()</span>
<span id="cb9-43"><a href="#cb9-43"></a>        <span class="op">.</span>map_err(<span class="op">|</span>element<span class="op">|</span> <span class="pp">anyhow!</span>(<span class="st">&quot;Error converting {:#?} to HtmlCanvasElement&quot;</span><span class="op">,</span> element))</span>
<span id="cb9-44"><a href="#cb9-44"></a><span class="op">}</span></span>
<span id="cb9-45"><a href="#cb9-45"></a></span>
<span id="cb9-46"><a href="#cb9-46"></a><span class="kw">pub</span> <span class="kw">fn</span> context() <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>CanvasRenderingContext2d<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb9-47"><a href="#cb9-47"></a>    canvas()<span class="op">?</span></span>
<span id="cb9-48"><a href="#cb9-48"></a>        <span class="op">.</span>get_context(<span class="st">&quot;2d&quot;</span>)</span>
<span id="cb9-49"><a href="#cb9-49"></a>        <span class="op">.</span>map_err(<span class="op">|</span>js_value<span class="op">|</span> <span class="pp">anyhow!</span>(<span class="st">&quot;Error getting 2d context {:#?}&quot;</span><span class="op">,</span> js_value))<span class="op">?</span></span>
<span id="cb9-50"><a href="#cb9-50"></a>        <span class="op">.</span>ok_or_else(<span class="op">||</span> <span class="pp">anyhow!</span>(<span class="st">&quot;No 2d context found&quot;</span>))<span class="op">?</span></span>
<span id="cb9-51"><a href="#cb9-51"></a>        <span class="op">.</span><span class="pp">dyn_into::</span><span class="op">&lt;</span><span class="pp">web_sys::</span>CanvasRenderingContext2d<span class="op">&gt;</span>()</span>
<span id="cb9-52"><a href="#cb9-52"></a>        <span class="op">.</span>map_err(<span class="op">|</span>element<span class="op">|</span> <span class="op">{</span></span>
<span id="cb9-53"><a href="#cb9-53"></a>            <span class="pp">anyhow!</span>(</span>
<span id="cb9-54"><a href="#cb9-54"></a>                <span class="st">&quot;Error converting {:#?} to CanvasRenderingContext2d&quot;</span><span class="op">,</span></span>
<span id="cb9-55"><a href="#cb9-55"></a>                element</span>
<span id="cb9-56"><a href="#cb9-56"></a>            )</span>
<span id="cb9-57"><a href="#cb9-57"></a>        <span class="op">}</span>)</span>
<span id="cb9-58"><a href="#cb9-58"></a><span class="op">}</span></span>
<span id="cb9-59"><a href="#cb9-59"></a></span>
<span id="cb9-60"><a href="#cb9-60"></a><span class="kw">pub</span> <span class="kw">fn</span> spawn_local<span class="op">&lt;</span>F<span class="op">&gt;</span>(future<span class="op">:</span> F)</span>
<span id="cb9-61"><a href="#cb9-61"></a><span class="kw">where</span></span>
<span id="cb9-62"><a href="#cb9-62"></a>    F<span class="op">:</span> <span class="bu">Future</span><span class="op">&lt;</span>Output <span class="op">=</span> ()<span class="op">&gt;</span> <span class="op">+</span> <span class="ot">&#39;static</span><span class="op">,</span></span>
<span id="cb9-63"><a href="#cb9-63"></a><span class="op">{</span></span>
<span id="cb9-64"><a href="#cb9-64"></a>    <span class="pp">wasm_bindgen_futures::</span>spawn_local(future)<span class="op">;</span></span>
<span id="cb9-65"><a href="#cb9-65"></a><span class="op">}</span></span>
<span id="cb9-66"><a href="#cb9-66"></a></span>
<span id="cb9-67"><a href="#cb9-67"></a><span class="kw">pub</span> <span class="kw">async</span> <span class="kw">fn</span> fetch_with_str(resource<span class="op">:</span> <span class="op">&amp;</span><span class="dt">str</span>) <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>JsValue<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb9-68"><a href="#cb9-68"></a>    <span class="pp">JsFuture::</span>from(window()<span class="op">?.</span>fetch_with_str(resource))</span>
<span id="cb9-69"><a href="#cb9-69"></a>        <span class="op">.</span><span class="kw">await</span></span>
<span id="cb9-70"><a href="#cb9-70"></a>        <span class="op">.</span>map_err(<span class="op">|</span>err<span class="op">|</span> <span class="pp">anyhow!</span>(<span class="st">&quot;error fetching {:#?}&quot;</span><span class="op">,</span> err))</span>
<span id="cb9-71"><a href="#cb9-71"></a><span class="op">}</span></span>
<span id="cb9-72"><a href="#cb9-72"></a></span>
<span id="cb9-73"><a href="#cb9-73"></a></span>
<span id="cb9-74"><a href="#cb9-74"></a><span class="kw">pub</span> <span class="kw">async</span> <span class="kw">fn</span> fetch_response(resource<span class="op">:</span> <span class="op">&amp;</span><span class="dt">str</span>) <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>Response<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb9-75"><a href="#cb9-75"></a>    fetch_with_str(resource)</span>
<span id="cb9-76"><a href="#cb9-76"></a>                        <span class="op">.</span><span class="kw">await</span><span class="op">?</span></span>
<span id="cb9-77"><a href="#cb9-77"></a>                        <span class="op">.</span>dyn_into()</span>
<span id="cb9-78"><a href="#cb9-78"></a>                        <span class="op">.</span>map_err(<span class="op">|</span>err<span class="op">|</span> <span class="pp">anyhow!</span>(<span class="st">&quot;error converting fetch to Response {:#?}&quot;</span><span class="op">,</span> err))</span>
<span id="cb9-79"><a href="#cb9-79"></a><span class="op">}</span></span>
<span id="cb9-80"><a href="#cb9-80"></a></span>
<span id="cb9-81"><a href="#cb9-81"></a></span>
<span id="cb9-82"><a href="#cb9-82"></a><span class="kw">pub</span> <span class="kw">async</span> <span class="kw">fn</span> fetch_json(json_path<span class="op">:</span> <span class="op">&amp;</span><span class="dt">str</span>) <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>JsValue<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb9-83"><a href="#cb9-83"></a>    <span class="kw">let</span> resp <span class="op">=</span> fetch_response(json_path)<span class="op">.</span><span class="kw">await</span><span class="op">?;</span></span>
<span id="cb9-84"><a href="#cb9-84"></a>    <span class="pp">JsFuture::</span>from( resp<span class="op">.</span>json()</span>
<span id="cb9-85"><a href="#cb9-85"></a>                        <span class="op">.</span>map_err(<span class="op">|</span>err<span class="op">|</span> <span class="pp">anyhow!</span>(<span class="st">&quot;Could not get JSON from response {:#?}&quot;</span><span class="op">,</span> err))<span class="op">?,</span></span>
<span id="cb9-86"><a href="#cb9-86"></a>    )</span>
<span id="cb9-87"><a href="#cb9-87"></a>    <span class="op">.</span><span class="kw">await</span></span>
<span id="cb9-88"><a href="#cb9-88"></a>    <span class="op">.</span>map_err(<span class="op">|</span>err<span class="op">|</span> <span class="pp">anyhow!</span>(<span class="st">&quot;error fetching JSON {:#?}&quot;</span><span class="op">,</span> err))</span>
<span id="cb9-89"><a href="#cb9-89"></a><span class="op">}</span></span>
<span id="cb9-90"><a href="#cb9-90"></a></span>
<span id="cb9-91"><a href="#cb9-91"></a></span>
<span id="cb9-92"><a href="#cb9-92"></a><span class="kw">pub</span> <span class="kw">async</span> <span class="kw">fn</span> fetch_array_buffer(resource<span class="op">:</span> <span class="op">&amp;</span><span class="dt">str</span>) <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>ArrayBuffer<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb9-93"><a href="#cb9-93"></a>    <span class="kw">let</span> array_buffer <span class="op">=</span> fetch_response(resource)</span>
<span id="cb9-94"><a href="#cb9-94"></a>                        <span class="op">.</span><span class="kw">await</span><span class="op">?</span></span>
<span id="cb9-95"><a href="#cb9-95"></a>                        <span class="op">.</span>array_buffer()</span>
<span id="cb9-96"><a href="#cb9-96"></a>                        <span class="op">.</span>map_err(<span class="op">|</span>err<span class="op">|</span> <span class="pp">anyhow!</span>(<span class="st">&quot;Error loading array buffer {:#?}&quot;</span><span class="op">,</span> err))<span class="op">?;</span></span>
<span id="cb9-97"><a href="#cb9-97"></a></span>
<span id="cb9-98"><a href="#cb9-98"></a>    <span class="pp">JsFuture::</span>from(array_buffer)</span>
<span id="cb9-99"><a href="#cb9-99"></a>                        <span class="op">.</span><span class="kw">await</span></span>
<span id="cb9-100"><a href="#cb9-100"></a>                        <span class="op">.</span>map_err(<span class="op">|</span>err<span class="op">|</span> <span class="pp">anyhow!</span>(<span class="st">&quot;Error converting array buffer into a future {:#?}&quot;</span><span class="op">,</span> err))<span class="op">?</span></span>
<span id="cb9-101"><a href="#cb9-101"></a>                        <span class="op">.</span>dyn_into()</span>
<span id="cb9-102"><a href="#cb9-102"></a>                        <span class="op">.</span>map_err(<span class="op">|</span>err<span class="op">|</span> <span class="pp">anyhow!</span>(<span class="st">&quot;Error converting raw JSValue to ArrayBuffer {:#?}&quot;</span><span class="op">,</span> err))</span>
<span id="cb9-103"><a href="#cb9-103"></a><span class="op">}</span></span>
<span id="cb9-104"><a href="#cb9-104"></a></span>
<span id="cb9-105"><a href="#cb9-105"></a></span>
<span id="cb9-106"><a href="#cb9-106"></a></span>
<span id="cb9-107"><a href="#cb9-107"></a><span class="co">/*</span></span>
<span id="cb9-108"><a href="#cb9-108"></a><span class="co">This function is just a wrapper around HtmlImageElement ; there&#39;s not much to</span></span>
<span id="cb9-109"><a href="#cb9-109"></a><span class="co">explain. In the future, we may decide we want our own type for images, but for now,</span></span>
<span id="cb9-110"><a href="#cb9-110"></a><span class="co">we&#39;ll stick with the browser-provided type.</span></span>
<span id="cb9-111"><a href="#cb9-111"></a><span class="co">*/</span></span>
<span id="cb9-112"><a href="#cb9-112"></a><span class="kw">pub</span> <span class="kw">fn</span> new_image() <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>HtmlImageElement<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb9-113"><a href="#cb9-113"></a>    <span class="pp">HtmlImageElement::</span>new()<span class="op">.</span>map_err(<span class="op">|</span>err<span class="op">|</span> <span class="pp">anyhow!</span>(<span class="st">&quot;Could not create HtmlImageElement: {:#?}&quot;</span><span class="op">,</span> err))</span>
<span id="cb9-114"><a href="#cb9-114"></a><span class="op">}</span></span>
<span id="cb9-115"><a href="#cb9-115"></a></span>
<span id="cb9-116"><a href="#cb9-116"></a><span class="kw">pub</span> <span class="kw">type</span> LoopClosure <span class="op">=</span> Closure<span class="op">&lt;</span><span class="kw">dyn</span> <span class="bu">FnMut</span>(<span class="dt">f64</span>)<span class="op">&gt;;</span></span>
<span id="cb9-117"><a href="#cb9-117"></a><span class="kw">pub</span> <span class="kw">fn</span> create_raf_closure(f<span class="op">:</span> <span class="kw">impl</span> <span class="bu">FnMut</span>(<span class="dt">f64</span>) <span class="op">+</span> <span class="ot">&#39;static</span>) <span class="op">-&gt;</span> LoopClosure <span class="op">{</span></span>
<span id="cb9-118"><a href="#cb9-118"></a>    closure_wrap(<span class="dt">Box</span><span class="pp">::</span>new(f))</span>
<span id="cb9-119"><a href="#cb9-119"></a><span class="op">}</span></span>
<span id="cb9-120"><a href="#cb9-120"></a></span>
<span id="cb9-121"><a href="#cb9-121"></a><span class="kw">pub</span> <span class="kw">fn</span> request_animation_frame(callback<span class="op">:</span> <span class="op">&amp;</span>Closure<span class="op">&lt;</span><span class="kw">dyn</span> <span class="bu">FnMut</span>(<span class="dt">f64</span>)<span class="op">&gt;</span>) <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span><span class="dt">i32</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb9-122"><a href="#cb9-122"></a>    window()<span class="op">?</span></span>
<span id="cb9-123"><a href="#cb9-123"></a>        <span class="op">.</span>request_animation_frame(callback<span class="op">.</span>as_ref()<span class="op">.</span>unchecked_ref())</span>
<span id="cb9-124"><a href="#cb9-124"></a>        <span class="op">.</span>map_err(<span class="op">|</span>err<span class="op">|</span> <span class="pp">anyhow!</span>(<span class="st">&quot;Cannot request animation frame {:#?}&quot;</span><span class="op">,</span> err))</span>
<span id="cb9-125"><a href="#cb9-125"></a><span class="op">}</span></span>
<span id="cb9-126"><a href="#cb9-126"></a></span>
<span id="cb9-127"><a href="#cb9-127"></a><span class="co">/*</span></span>
<span id="cb9-128"><a href="#cb9-128"></a><span class="co">We just mimic the exact same type signature of the</span></span>
<span id="cb9-129"><a href="#cb9-129"></a><span class="co">Closure::once function from wasm_bindgen .</span></span>
<span id="cb9-130"><a href="#cb9-130"></a><span class="co">*/</span></span>
<span id="cb9-131"><a href="#cb9-131"></a><span class="kw">pub</span> <span class="kw">fn</span> closure_once<span class="op">&lt;</span>F<span class="op">,</span> A<span class="op">,</span> R<span class="op">&gt;</span>(fn_once<span class="op">:</span> F) <span class="op">-&gt;</span> Closure<span class="op">&lt;</span><span class="pp">F::</span><span class="bu">FnMut</span><span class="op">&gt;</span></span>
<span id="cb9-132"><a href="#cb9-132"></a><span class="kw">where</span></span>
<span id="cb9-133"><a href="#cb9-133"></a>    F<span class="op">:</span> <span class="ot">&#39;static</span> <span class="op">+</span> WasmClosureFnOnce<span class="op">&lt;</span>A<span class="op">,</span> R<span class="op">&gt;,</span></span>
<span id="cb9-134"><a href="#cb9-134"></a><span class="op">{</span></span>
<span id="cb9-135"><a href="#cb9-135"></a>    <span class="pp">Closure::</span>once(fn_once)</span>
<span id="cb9-136"><a href="#cb9-136"></a><span class="op">}</span></span>
<span id="cb9-137"><a href="#cb9-137"></a></span>
<span id="cb9-138"><a href="#cb9-138"></a><span class="kw">pub</span> <span class="kw">fn</span> closure_wrap<span class="op">&lt;</span>T<span class="op">:</span> WasmClosure <span class="op">+</span> <span class="op">?</span><span class="bu">Sized</span><span class="op">&gt;</span>(data<span class="op">:</span> <span class="dt">Box</span><span class="op">&lt;</span>T<span class="op">&gt;</span>) <span class="op">-&gt;</span> Closure<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb9-139"><a href="#cb9-139"></a>    <span class="pp">Closure::</span>wrap(data)</span>
<span id="cb9-140"><a href="#cb9-140"></a><span class="op">}</span></span>
<span id="cb9-141"><a href="#cb9-141"></a></span>
<span id="cb9-142"><a href="#cb9-142"></a></span>
<span id="cb9-143"><a href="#cb9-143"></a><span class="kw">pub</span> <span class="kw">fn</span> now() <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span><span class="dt">f64</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb9-144"><a href="#cb9-144"></a>    <span class="cn">Ok</span>(window()<span class="op">?</span></span>
<span id="cb9-145"><a href="#cb9-145"></a>        <span class="op">.</span>performance()</span>
<span id="cb9-146"><a href="#cb9-146"></a>        <span class="op">.</span>ok_or_else(<span class="op">||</span> <span class="pp">anyhow!</span>(<span class="st">&quot;Performance object not found&quot;</span>))<span class="op">?</span></span>
<span id="cb9-147"><a href="#cb9-147"></a>        <span class="op">.</span>now())</span>
<span id="cb9-148"><a href="#cb9-148"></a><span class="op">}</span></span>
<span id="cb9-149"><a href="#cb9-149"></a></span>
<span id="cb9-150"><a href="#cb9-150"></a></span>
<span id="cb9-151"><a href="#cb9-151"></a><span class="co">//------------- UI</span></span>
<span id="cb9-152"><a href="#cb9-152"></a><span class="kw">pub</span> <span class="kw">fn</span> draw_ui(html<span class="op">:</span> <span class="op">&amp;</span><span class="dt">str</span>) <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>()<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb9-153"><a href="#cb9-153"></a>    find_ui()<span class="op">?</span></span>
<span id="cb9-154"><a href="#cb9-154"></a>        <span class="op">.</span>insert_adjacent_html(<span class="st">&quot;afterbegin&quot;</span><span class="op">,</span> html)</span>
<span id="cb9-155"><a href="#cb9-155"></a>        <span class="op">.</span>map_err(<span class="op">|</span>err<span class="op">|</span> <span class="pp">anyhow!</span>(<span class="st">&quot;Could not insert html {:#?}&quot;</span><span class="op">,</span> err))</span>
<span id="cb9-156"><a href="#cb9-156"></a><span class="op">}</span></span>
<span id="cb9-157"><a href="#cb9-157"></a></span>
<span id="cb9-158"><a href="#cb9-158"></a><span class="kw">pub</span> <span class="kw">fn</span> hide_ui() <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>()<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb9-159"><a href="#cb9-159"></a>    <span class="kw">let</span> ui <span class="op">=</span> find_ui()<span class="op">?;</span></span>
<span id="cb9-160"><a href="#cb9-160"></a></span>
<span id="cb9-161"><a href="#cb9-161"></a>    <span class="cf">if</span> <span class="kw">let</span> <span class="cn">Some</span>(child) <span class="op">=</span> ui<span class="op">.</span>first_child() <span class="op">{</span></span>
<span id="cb9-162"><a href="#cb9-162"></a>        ui<span class="op">.</span>remove_child(<span class="op">&amp;</span>child)</span>
<span id="cb9-163"><a href="#cb9-163"></a>            <span class="op">.</span>map(<span class="op">|</span>_removed_child<span class="op">|</span> ())</span>
<span id="cb9-164"><a href="#cb9-164"></a>            <span class="op">.</span>map_err(<span class="op">|</span>err<span class="op">|</span> <span class="pp">anyhow!</span>(<span class="st">&quot;Failed to remove child {:#?}&quot;</span><span class="op">,</span> err))</span>
<span id="cb9-165"><a href="#cb9-165"></a>            <span class="op">.</span>and_then(<span class="op">|</span>_unit<span class="op">|</span> <span class="op">{</span></span>
<span id="cb9-166"><a href="#cb9-166"></a>                canvas()<span class="op">?</span></span>
<span id="cb9-167"><a href="#cb9-167"></a>                    <span class="op">.</span>focus()</span>
<span id="cb9-168"><a href="#cb9-168"></a>                    <span class="op">.</span>map_err(<span class="op">|</span>err<span class="op">|</span> <span class="pp">anyhow!</span>(<span class="st">&quot;Could not set focus to canvas! {:#?}&quot;</span><span class="op">,</span> err))</span>
<span id="cb9-169"><a href="#cb9-169"></a>            <span class="op">}</span>)</span>
<span id="cb9-170"><a href="#cb9-170"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb9-171"><a href="#cb9-171"></a>        <span class="cn">Ok</span>(())</span>
<span id="cb9-172"><a href="#cb9-172"></a>    <span class="op">}</span></span>
<span id="cb9-173"><a href="#cb9-173"></a><span class="op">}</span></span>
<span id="cb9-174"><a href="#cb9-174"></a></span>
<span id="cb9-175"><a href="#cb9-175"></a><span class="kw">fn</span> find_ui() <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>Element<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb9-176"><a href="#cb9-176"></a>    document()<span class="op">.</span>and_then(<span class="op">|</span>doc<span class="op">|</span> <span class="op">{</span></span>
<span id="cb9-177"><a href="#cb9-177"></a>        doc<span class="op">.</span>get_element_by_id(<span class="st">&quot;ui&quot;</span>)</span>
<span id="cb9-178"><a href="#cb9-178"></a>            <span class="op">.</span>ok_or_else(<span class="op">||</span> <span class="pp">anyhow!</span>(<span class="st">&quot;UI element not found&quot;</span>))</span>
<span id="cb9-179"><a href="#cb9-179"></a>    <span class="op">}</span>)</span>
<span id="cb9-180"><a href="#cb9-180"></a><span class="op">}</span></span>
<span id="cb9-181"><a href="#cb9-181"></a></span>
<span id="cb9-182"><a href="#cb9-182"></a><span class="kw">pub</span> <span class="kw">fn</span> find_html_element_by_id(id<span class="op">:</span> <span class="op">&amp;</span><span class="dt">str</span>) <span class="op">-&gt;</span> <span class="dt">Result</span><span class="op">&lt;</span>HtmlElement<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb9-183"><a href="#cb9-183"></a>    document()</span>
<span id="cb9-184"><a href="#cb9-184"></a>        <span class="op">.</span>and_then(<span class="op">|</span>doc<span class="op">|</span> <span class="op">{</span></span>
<span id="cb9-185"><a href="#cb9-185"></a>            doc<span class="op">.</span>get_element_by_id(id)</span>
<span id="cb9-186"><a href="#cb9-186"></a>                <span class="op">.</span>ok_or_else(<span class="op">||</span> <span class="pp">anyhow!</span>(<span class="st">&quot;Element with id {} not found&quot;</span><span class="op">,</span> id))</span>
<span id="cb9-187"><a href="#cb9-187"></a>        <span class="op">}</span>)</span>
<span id="cb9-188"><a href="#cb9-188"></a>        <span class="op">.</span>and_then(<span class="op">|</span>element<span class="op">|</span> <span class="op">{</span></span>
<span id="cb9-189"><a href="#cb9-189"></a>            element</span>
<span id="cb9-190"><a href="#cb9-190"></a>                <span class="op">.</span><span class="pp">dyn_into::</span><span class="op">&lt;</span>HtmlElement<span class="op">&gt;</span>()</span>
<span id="cb9-191"><a href="#cb9-191"></a>                <span class="op">.</span>map_err(<span class="op">|</span>err<span class="op">|</span> <span class="pp">anyhow!</span>(<span class="st">&quot;Could not cast into HtmlElement {:#?}&quot;</span><span class="op">,</span> err))</span>
<span id="cb9-192"><a href="#cb9-192"></a>        <span class="op">}</span>)</span>
<span id="cb9-193"><a href="#cb9-193"></a><span class="op">}</span></span>
<span id="cb9-194"><a href="#cb9-194"></a></span>
<span id="cb9-195"><a href="#cb9-195"></a><span class="co">//===============================</span></span>
<span id="cb9-196"><a href="#cb9-196"></a><span class="at">#[</span>cfg<span class="at">(</span>test<span class="at">)]</span></span>
<span id="cb9-197"><a href="#cb9-197"></a><span class="kw">mod</span> tests <span class="op">{</span></span>
<span id="cb9-198"><a href="#cb9-198"></a>    <span class="kw">use</span> <span class="kw">super</span><span class="pp">::</span><span class="op">*;</span></span>
<span id="cb9-199"><a href="#cb9-199"></a>    <span class="kw">use</span> <span class="pp">wasm_bindgen_test::</span>wasm_bindgen_test<span class="op">;</span></span>
<span id="cb9-200"><a href="#cb9-200"></a>    <span class="pp">wasm_bindgen_test::wasm_bindgen_test_configure!</span>(run_in_browser)<span class="op">;</span></span>
<span id="cb9-201"><a href="#cb9-201"></a></span>
<span id="cb9-202"><a href="#cb9-202"></a>    <span class="at">#[</span>wasm_bindgen_test<span class="at">]</span></span>
<span id="cb9-203"><a href="#cb9-203"></a>    <span class="kw">async</span> <span class="kw">fn</span> test_error_loading_json() <span class="op">{</span></span>
<span id="cb9-204"><a href="#cb9-204"></a>        <span class="kw">let</span> json <span class="op">=</span> fetch_json(<span class="st">&quot;not_there.json&quot;</span>)<span class="op">.</span><span class="kw">await</span><span class="op">;</span></span>
<span id="cb9-205"><a href="#cb9-205"></a>        <span class="pp">assert_eq!</span>(json<span class="op">.</span>is_err()<span class="op">,</span> <span class="cn">true</span>)<span class="op">;</span></span>
<span id="cb9-206"><a href="#cb9-206"></a>    <span class="op">}</span></span>
<span id="cb9-207"><a href="#cb9-207"></a><span class="op">}</span></span></code></pre></div>
</main>
<script src="https://lerina.github.io/js/toc.js"></script>
<script>
let anchor= document.createElement('a');
anchor.href="javascript:closeNav()"; //void(0)"; //anchor[0].onclick = closeNav();
anchor.className = "closebtn";  
anchor.innerHTML="&times;";
document.getElementById("TOC").prepend(anchor);

let navCrumbs= document.createElement('div');
navCrumbs.className = "hover-nav";
navCrumbs.innerHTML = `
<div class="hover-nav">
<ul>
<li><a href="../../../../index.html">⇦ home</a></li>
<li><a href="../../index.html">lerina</a></li>
<li><a href="../index.html">code</a></li>
</ul>
</div>`;
document.getElementById("TOC").prepend(navCrumbs); 
</script>
</body>
</html>

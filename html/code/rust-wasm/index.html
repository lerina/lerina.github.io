<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>index index</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="https://lerina.github.io/css/styles_min.css" />
</head>
<body>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#learn-rustwasm-without-npm-and-webpack">Learn Rust/Wasm without NPM and webpack</a>
<ul>
<li><a href="#motivation">Motivation</a></li>
<li><a href="#no-bundle-wasm-by-example">no-bundle Wasm by example</a></li>
<li><a href="#list">Example list</a></li>
</ul></li>
</ul>
</nav>
<div class="navbar">
<a class="openbtn" onclick="openNav()">☰</a>
</div>
<main>
<h1 id="learn-rustwasm-without-npm-and-webpack">Learn Rust/Wasm without NPM and webpack</h1>
<blockquote>
<p>These pages are dedicated to Understanding and developing in Rust/wasm without bloat or bundles.</p>
</blockquote>
<p>If you need to learn Rust or unrust your Rust these are you best free options.</p>
<ul>
<li><a href="https://doc.rust-lang.org/book/title-page.html" target="_blank">The book</a></li>
<li>The best youtube resource to learn Rust is <a href="https://www.youtube.com/c/LetsGetRusty/playlists" target="_blank">LetsGetRusty</a></li>
</ul>
<h2 id="motivation">Motivation</h2>
<p>The Rust programming language is a great contender, if you want to:</p>
<ul>
<li>to build webassembly/JavaScript apps for the web or</li>
<li>target some specific module that need speeding, memory safety, or both.</li>
</ul>
<p>However, most Rust-wasm tutorials, lean heavily on “NPM and webpack”, just to get a “hello world”.</p>
<p>More on that <a href="./motivation.html" target="_blank">here</a></p>
<blockquote>
<p>The following pages brings under one location all those bits and pieces you want to know in order to understand and build wasm stuff with Rust.</p>
</blockquote>
<p>More specifically the intent is to address these wishes:</p>
<ul>
<li>Rust developers should be able to produce WebAssembly packages for use in JavaScript without requiring a Node.js development environment</li>
<li>JavaScript developers should be able to use WebAssembly without requiring a Rust development environment</li>
</ul>
<p>source: <a href="https://hacks.mozilla.org/2018/04/hello-wasm-pack/" target="_bank">Hello wasm-pack!</a></p>
<h2 id="no-bundle-wasm-by-example">no-bundle Wasm by example</h2>
<h3 id="the-tools">The tools</h3>
<p>Webassembly is still a moving target and some tools and convenient crates make the experience more appealing.</p>
<p>In the following pages we’ll dive into understanding how to transform most webpack, NPM loaded Rust/wasm tutorial into lean no-bloat rust-wasm with no-bundle.</p>
<p>We’ll use and get familliar with the following tools and crates:</p>
<ul>
<li><a href="https://rustwasm.github.io/wasm-pack/installer/" target="_blank">wasm-pack</a>, ( <a href="https://rustwasm.github.io/docs/wasm-pack/introduction.html" target="_blank">docs</a>)<br />
</li>
<li><a href="https://github.com/rustwasm/wasm-bindgen" target="_blank">wasm-bindgen</a>, (<a href="https://rustwasm.github.io/docs/wasm-bindgen/" target="_blank">docs</a>)<br />
</li>
<li><a href="https://lib.rs/crates/js-sys" target="_blank">js-sys</a> &amp; <a href="https://lib.rs/crates/web-sys" target="_blank">web-sys</a> (<a href="https://rustwasm.github.io/wasm-bindgen/examples/wasm-in-wasm.html" target="_blank">js-sys example</a>, <a href="https://rustwasm.github.io/wasm-bindgen/examples/dom.html" target="_blank">web-sys examples</a> )</li>
</ul>
<!-- 
[trunkrs.dev](https://trunkrs.dev/){target="_blank"}  
-->
<h3 id="let-the-tutorial-begin">Let the tutorial begin!</h3>
<p>Wasm without npm and bundlers is actually quite simple. Unfortunately it’s not easy to find <strong>complete examples</strong> on the web.</p>
<p>We’ll convert each examples from the <a href="https://rustwasm.github.io/docs/wasm-bindgen/" target="_blank">wasm-bindgen guide</a> to a no-bundle version. For each example or demo:</p>
<ul>
<li>Part I, will help you get the example running.</li>
<li>Part II, will expose or highlight aspects of the code related to wasm-bindgen, wasm-pack or Rust.</li>
</ul>
<p>It is assumed that you have Rust on your machine and cargo ready for use. (If not get the installer <a href="https://rustup.rs/" target="_blank">here: rustup.rs</a>).</p>
<h4 id="get-wasm-pack-and-something-to-serve-our-website-locally">0. Get wasm-pack and something to serve our website locally</h4>
<p>Let’s prepare our workspace, and setup our tools.</p>
<h5 id="install-wasm-pack">0.1 Install wasm-pack</h5>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="ex">cargo</span> install wasm-pack</span></code></pre></div>
<p>wasm-pack helps you build rust-generated WebAssembly packages Its a useful convenience that is widely used by the Rust community.</p>
<p>If your interested see <a href="./wasm-pack_under_the_hood.html" target="_blank">wasm-pack under the hood</a></p>
<h5 id="install-a-local-tiny-static-file-server">0.2 Install a local tiny static file server</h5>
<p>We need something to serve your website so we can test and see what we develop on our local machine. If you don’t have one installed you can use <code>H</code>ost <code>T</code>hese <code>T</code>hings <code>P</code>lease - a basic http server for hosting a folder fast and simply <a href="https://github.com/thecoshman/http" target="_blank">http</a></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="ex">cargo</span> install https</span></code></pre></div>
<p>Note:</p>
<p><a href="https://trunkrs.dev/" target="_blank">trunkrs.dev</a> is getting traction in the Rust community but its a much more ambitious tool and beyond our needs here.</p>
<h3 id="formula-for-converting-examples">Formula for Converting examples</h3>
<h4 id="seven-steps-to-hello-world">Seven steps to hello world</h4>
<ol type="1">
<li>Set up your file structure</li>
<li>Edit Cargo.toml: Set the <em>crate-type</em> and add wasm-bindgen as a dependency.</li>
<li>Get the lib.rs code for hello_world</li>
<li>Specify type module in index.html</li>
<li>import with file extension included and Wrap the code in async/await index.js</li>
<li>build with wasm-pack</li>
<li>Run the web server and open your browser</li>
</ol>
<p>Let’s see that in practice with the first example: <a href="./001_hello_world.html">wasm Hello world</a></p>
<hr />
<h2 id="list">Example list</h2>
<!-- 

## One more thing (Shrink the size)

This is Optional, and will only do it this once for these examples series.

Wasm files are notorious for being large by default.
You can reduce the size with [wasm-gc](https://github.com/alexcrichton/wasm-gc){target="_blank"}

The wasm-pack (and wasm-bindgen) project will already run this by default for you, so there's no need to run it again. 


Using the official way through Cargo.toml:

```
[profile.release]
# optimization for size ( more aggressive )
opt-level = 'z'

# optimization for size
# opt-level = 's'

# link time optimization using using whole-program analysis
lto = true
#
wasm-opt = ['-Oz']
```
and building with the `--release` flag

```sh
wasm-pack build --release --target web --no-typescript --out-dir www/pkg
```

Original size: 1.8M hello_world.wasm
New size: 109k hello_world.wasm

However using wasm-gc ourself we get a mush smaller size


```sh
wasm-gc target/wasm32-unknown-unknown/release/hello_world.wasm 
```
Original size: 1.8M hello_world.wasm
New size: 28k hello_world.wasm


humm.
-->
<hr />
<p>Move on to the first example: <a href="./001_hello_world.html">wasm Hello world</a></p>
</main>
<script src="https://lerina.github.io/js/toc.js"></script>
<script>
let anchor= document.createElement('a');
anchor.href="javascript:closeNav()"; //void(0)"; //anchor[0].onclick = closeNav();
anchor.className = "closebtn";  
anchor.innerHTML="&times;";
document.getElementById("TOC").prepend(anchor);

let navCrumbs= document.createElement('div');
navCrumbs.className = "hover-nav";
navCrumbs.innerHTML = `
<div class="hover-nav">
<ul>
<li><a href="../../../../index.html">⇦ home</a></li>
<li><a href="../index.html">code</a></li>
</ul>
</div>`;
document.getElementById("TOC").prepend(navCrumbs); 
</script>
</body>
</html>
